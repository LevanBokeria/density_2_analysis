---
title: "Exploring reaction times"
output:
  html_document:
    number_sections: false
    
knit: (function(input, ...) {
    rmarkdown::render(
      input,
      knit_root_dir = rprojroot::find_rstudio_root_file(),
      output_file = paste0(
      rprojroot::find_rstudio_root_file(),
      '/results/',
      'chose_sparse_paradigm_2_3_qc_filtered_',Sys.Date(),'.html'

      ),
      envir = globalenv()
    )
  })
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Suppress summarise info
options(dplyr.summarise.inform = FALSE)

```

```{r load-libraries}

# Clean the environment and load libraries ############################

rm(list=ls())

source('./scripts/utils/load_all_libraries.R')

```

# Load the data and set flags

(code hidden)

```{r load-transform-tt-data}

reportBF = function(x, digits){
        round(as.numeric(as.vector(x)), digits)
}

plot_dep_var <- 'post_pre_diff'

qc_filter <- T
print(paste0('QC filter? ', qc_filter))


experiment <- c('experiment_1')

print(paste0('Which pilot paradigm? ', experiment))

source('./scripts/utils/load_transform_tt_data.R')
source('./scripts/utils/summary_stats_for_various_factors.R')

# Flags and settings

chose_sparse_color  <- 'blue'
chose_highdim_color <- 'green'
accuracy_color      <- 'yellow'
rt_color            <- 'gray'

# Show the basic table
tt_long %>%
        filter(trial_index == 1,session == 1,trial_stage == 'pre_exposure') %>%
        group_by(counterbalancing,
                 prolific_id) %>%
        summarise(n = n()) %>%
        knitr::kable(caption = 'Participants and counterbalancing') %>%
        kable_styling(bootstrap_options = "striped")

```

# Middle triplets, against 0

## Plot:

```{r mid-triplets-vs-0-plot}

ylimits <- c(-0.2,0.2)

fig1 <- tt_part_sum_stats %>%
        filter(
                # triplet_location == 'across_density_regions',
               dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x='All participants',
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2,
                    width = 0.6) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red')  +
        ylab('Post-Pre Mean RT') +
        xlab('') +
        ggtitle('All participants') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) 

fig2 <- tt_part_sum_stats %>%
        filter(
                # triplet_location == 'across_density_regions',
               dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2,
                    width = 0.6) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red')  +
        ylab('Post-Pre Mean RT') +
        xlab('') +
        ggtitle('Each counterbalancing group') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) 

p <- grid.arrange(fig1,fig2,
             nrow = 1
             # top = 'Post-pre RT'
             )

ggsave(filename = 'rt_mean_post_pre_diff.png', plot = p, path = './results/plots/', width = 5, height = 4, device='png', dpi=300)

```

# Bayes Factors

```{r mid-triplets-vs-0-effect-size}

tbl_effsize <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions') %>%
        cohens_d(mean_rt ~ 1,
                 mu = 0,
                 hedges.correction = FALSE)

```

```{r mid-triplets-vs-0-bayes-factor}

bf_data <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions') %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf <- reportBF(ttestBF(
        bf_data,
        nullInterval = null_interval
)[1],4)

```

```{r mid-triplets-vs-0-cb-groups}

bf_data_dense_left <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               counterbalancing == 'dense_left') %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

bf_data_dense_right <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               counterbalancing == 'dense_right') %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf_compare_cb <- reportBF(ttestBF(
        bf_data_dense_left,bf_data_dense_right,
)[1],4)

bf_dense_left <- reportBF(ttestBF(
        bf_data_dense_left,
        nullInterval = null_interval
)[1],4)

bf_dense_right <- reportBF(ttestBF(
        bf_data_dense_right,
        nullInterval = null_interval
)[1],4)


```


# Harderst middle triplets vs 0

## Plot

```{r mid-hardest-triplets-vs-0-plot}

ylimits <- c(-0.2,0.2)

fig1 <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(triplet_location == 'across_density_regions',
               dep_var_type == 'post_pre_diff',
               triplet_easiness == 0) %>%
        ggplot(aes(x='All participants',
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red')  +
        ylab('Post-Pre Mean RT') +
        xlab('') +
        ggtitle('All participants') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) 

fig2 <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(triplet_location == 'across_density_regions',
               dep_var_type == 'post_pre_diff',
               triplet_easiness == 0) %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') +
        ylab('Post-Pre Mean RT') +
        xlab('') +
        ggtitle('Each counterbalancing group') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) +
        scale_x_discrete(labels = c('Dense-Left','Dense-Right'))

p <- grid.arrange(fig1,fig2,
             nrow = 1)

ggsave(filename = 'rt_mean_post_pre_diff_middle_symmetric.png', plot = p, path = './results/plots/', width = 5, height = 4, device='png', dpi=300)

```

## Bayes factors

```{r mid-hardest-triplets-vs-0-effect-size}

tbl_effsize <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness == 0) %>%
        cohens_d(mean_rt ~ 1,
                 mu = 0,
                 hedges.correction = FALSE)

```

```{r mid-hardest-triplets-vs-0-bayes-factor}

bf_data <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness == 0) %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf <- reportBF(ttestBF(
        bf_data,
        nullInterval = null_interval
)[1],4)

```

```{r mid-harderst-triplets-vs-0-cb-groups}

bf_data_dense_left <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               counterbalancing == 'dense_left',
               triplet_easiness == 0) %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

bf_data_dense_right <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               counterbalancing == 'dense_right',
               triplet_easiness == 0) %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf_compare_cb <- reportBF(ttestBF(
        bf_data_dense_left,bf_data_dense_right,
)[1],4)

bf_dense_left <- reportBF(ttestBF(
        bf_data_dense_left,
        nullInterval = null_interval
)[1],4)

bf_dense_right <- reportBF(ttestBF(
        bf_data_dense_right,
        nullInterval = null_interval
)[1],4)


```


# Accuracy and RT dependence on triplet easiness

```{r accuracy-easiness}

tt_part_sum_stats_triplet_easiness %>%
        # filter() %>%
        # droplevels() %>%
        ggplot(aes(x=triplet_easiness,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') +
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +
        facet_wrap(~dep_var_type)

tt_part_sum_stats_triplet_easiness %>%
        # filter() %>%
        # droplevels() %>%
        ggplot(aes(x=triplet_easiness,
                   y=mean_correct)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') +
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +
        facet_wrap(~dep_var_type)

```



# Asymmetric triplets: interaction between skew and RT

## Plot

```{r asymmetric-interaction-skew-rt, fig.height=5, fig.width=7}

dep_var <- 'mean_rt'
which_easiness <- 8
y_coords <- c(-1600,1600)

fig1 <- tt_part_sum_stats_correct_ref_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness %in% c(which_easiness)
               ) %>%
        droplevels() %>%
        ggplot(aes(x=correct_ref_towards_dense_sparse,
                   y=.data[[dep_var]])) +
        geom_violin(fill = rt_color,
                    alpha = 0.2,
                    width = 0.6) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') +
        geom_line(aes(group=prolific_id),
                  alpha = 0.1) +
        ylab('RT Post-pre') +
        xlab('') +
        ggtitle('RT Post-pre') +
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) +
        theme(axis.text.x = element_text(size = 10)) +
        scale_x_discrete(labels = c('Correct High-Density','Correct Low-Density'))
# +
#         coord_cartesian(ylim = y_coords)

# Calculate the difference between ref_right and ref_left
ref_towards_dense_min_ref_towards_sparse_rt <- tt_part_sum_stats_correct_ref_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness %in% c(which_easiness)
               ) %>%
        droplevels() %>% 
        pivot_wider(id_cols = c(prolific_id,
                                counterbalancing),
                    names_from = correct_ref_towards_dense_sparse,
                    values_from = dep_var) %>% 
        mutate(ref_dense_min_ref_sparse = ref_towards_dense - ref_towards_sparse) 

fig2 <- ref_towards_dense_min_ref_towards_sparse_rt %>%
        ggplot(aes(x='',
                   y=ref_dense_min_ref_sparse)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2,
                    width = 0.6) +
        geom_boxplot(width = 0.15,
                     outlier.shape = '',
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') +
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +
        ylab('Difference value') +
        xlab('') +
        ggtitle('Group difference') +
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10))
# +
        # coord_cartesian(ylim = c(-2000,2000))


p <- grid.arrange(fig1,fig2,
             nrow = 1,
             widths = 2:1
# ,             top = paste0('Easy-', which_easiness, ' triplets'
                           )

ggsave(filename = paste0('rt_asymmetric_easy_',which_easiness, '_mean_post_pre_diff.png'), plot = p, path = './results/plots/', width = 6, height = 4, device='png', dpi=300)


```

## Bayes factor

```{r asymmetric-triplets-8-rt-effect-size}

tbl_effsize <- tt_part_sum_stats_correct_ref_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness == 8) %>% 
        cohens_d(mean_rt ~ 1,
                 mu = 0,
                 hedges.correction = FALSE)

```

```{r mid-hardest-triplets-vs-0-bayes-factor}

bf_data <- tt_part_sum_stats_triplet_location_easiness %>%
        filter(dep_var_type == 'post_pre_diff',
               triplet_location == 'across_density_regions',
               triplet_easiness == 0) %>%
        droplevels() %>% 
        select(mean_rt) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf <- reportBF(ttestBF(
        bf_data,
        nullInterval = null_interval
)[1],4)

```

# Regional analysis: across minus other areas

## Violin plots

```{r triplet-location-differences-easiness-levels, fig.width=6, fig.height=4, warning=F}

x_font_size <- 10
x_font_angle <- 0

# Now plot this
fig1 <- tt_part_sum_stats_triplet_location_easiness_differences %>%
        filter(dep_var_type == plot_dep_var,
               measure_type == 'rt',
               triplet_easiness == 0,
               difference_type == 'across_minus_avg_dense_sparse') %>% 
        ggplot(aes(x='All participants',
                   y=difference_value)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.2,
                     outlier.shape = '', 
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) + 
        # geom_line(aes(group=prolific_id),
        #           alpha = 0.2) +  
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=0.5,
             width=0.1,
             color='red') + 
        geom_hline(yintercept = 0, linetype = 'dashed') +      
        theme(text = element_text(size=x_font_size)) + 
        theme(axis.text.x = element_text(angle = x_font_angle)) + 
        ggtitle(paste0(plot_dep_var, '. rt. Diff scores'))  +
        ylab('Middle-avg(high+low) diff score') +
        xlab('') +
        ggtitle('All participants') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) +
        theme(axis.title.y = element_text(size = 10)) 

fig2 <- tt_part_sum_stats_triplet_location_easiness_differences %>%
        filter(dep_var_type == plot_dep_var,
               measure_type == 'rt',
               triplet_easiness == 0,
               difference_type == 'across_minus_avg_dense_sparse') %>% 
        ggplot(aes(x=counterbalancing,
                   y=difference_value)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.2,
                     outlier.shape = '', fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) + 
        # geom_line(aes(group=prolific_id),
        #           alpha = 0.2) +  
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=0.5,
             width=0.1,
             color='red') + 
        geom_hline(yintercept = 0, linetype = 'dashed') +      
        theme(text = element_text(size=x_font_size)) + 
        theme(axis.text.x = element_text(angle = x_font_angle)) + 
        # facet_wrap(~counterbalancing) +
        ggtitle(paste0(plot_dep_var, '. rt. Diff scores')) +
        ylab('Middle-avg(high+low) diff score') +
        xlab('') +
        ggtitle('Each counterbalancing group') + 
        theme(plot.title = element_text(hjust = 0.5)) +
        theme(plot.title = element_text(size = 10)) +
        theme(axis.title.y = element_text(size = 10)) +
        scale_x_discrete(labels = c('Dense-Left','Dense-Right'))

p <- grid.arrange(fig1,fig2,
             nrow = 1,
             widths = 1:2)

ggsave(filename = 'rt_within_template_diff.png', plot = p, path = './results/plots/', width = 5, height = 4, device='png', dpi=300)

```

## Bayes factors:

```{r bf-regional-analysis}
data_for_bf_regional_analysis <- tt_part_sum_stats_triplet_location_easiness_differences %>%
        filter(dep_var_type == plot_dep_var,
               measure_type == 'rt',
               triplet_easiness == 0,
               difference_type == 'across_minus_avg_dense_sparse') %>% 
        select(difference_value) %>% .[[1]]

null_interval <- c(-Inf,Inf)

bf_regional_analysis <- reportBF(ttestBF(
        data_for_bf_regional_analysis,
        nullInterval = null_interval
)[1],4)

print('Mean value')
mean(data_for_bf_regional_analysis)
sd(data_for_bf_regional_analysis)

print('BF01')
1/bf_regional_analysis

bf_regional_analysis_cb_groups <- tt_part_sum_stats_triplet_location_easiness_differences %>%
        filter(dep_var_type == plot_dep_var,
               measure_type == 'rt',
               triplet_easiness == 0,
               difference_type == 'across_minus_avg_dense_sparse') %>% 
        group_by(counterbalancing) %>%
        
        summarise(bf = reportBF(ttestBF(cur_data()$difference_value,
                                        nullInterval = null_interval)[1],4)) %>%
        ungroup()

1/bf_regional_analysis_cb_groups$bf

```



# Other stuff

```{r mid-triplets-vs-0-1-way-ANOVA}

data_for_bayes_anova <- tt_part_sum_stats_triplet_location %>%
        filter(triplet_location == 'across_density_regions',
               dep_var_type == 'post_pre_diff') %>%
        rename(
                Cb = counterbalancing,
                diff_scores = mean_rt
        )

bayes_aov <- anovaBF(diff_scores~
                             Cb,
                     data = data_for_bayes_anova,
                     whichModels = 'all',
                     whichRandom = 'ptp',
                     iterations = 10000)

# bayes_aov <- sort(bayes_aov, decreasing = TRUE)

bayes_aov %>% knitr::kable() %>%
        kable_styling(bootstrap_options = "striped")

# Whats the winning model?
bayes_aov_sorted <- sort(bayes_aov, decreasing = TRUE)
bayes_aov_sorted %>% knitr::kable(caption = 'Against the Null model') %>%
        kable_styling(bootstrap_options = "striped")

# # Compare everything to the full model
# bayes_aov[127]
# 
# bayes_aov_vs_full <- sort(bayes_aov/bayes_aov[127], decreasing = TRUE)
# bayes_aov_vs_full %>% knitr::kable(caption = 'Against the full model') %>%
#         kable_styling(bootstrap_options = "striped")
# 
# bayes_aov_sorted[1]
# 
# # How much more likely is this top winning model against a model NOT including the interaction term?
# bayes_aov_sorted[1]/bayes_aov_sorted[29]

```



# Over all trials, pre post and post-pre

```{r all-trials, fig.width=12, fig.height=3, warning=F}

#  
fig3 <- tt_part_sum_stats %>%
        #filter(dep_var_type == 'post_pre_diff') %>% 
        ggplot(aes(x=dep_var_type,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.2,
                     outlier.shape = '', 
                     fatten = 6) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) + 
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +     
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=1,
             width=0.1,
             color='red') +         
        geom_hline(yintercept = c(0,0.5), linetype = 'dashed') +         
        ggtitle('rt')

fig4 <- tt_part_sum_stats %>%
        #filter(dep_var_type == 'post_pre_diff') %>% 
        ggplot(aes(x=dep_var_type,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '',
                     fatten = 6) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +    
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=1,
             width=0.1,
             color='red') +         
        geom_hline(yintercept = c(0,0.5), linetype = 'dashed') +         
        facet_wrap(~counterbalancing)

grid.arrange(fig3,fig4,
             nrow = 1,
             widths = 1:2)
             
```

```{r triplet-location, fig.width=12, fig.height=7, warning=F}
x_font_size <- 10

fig3 <- tt_part_sum_stats_triplet_location %>%
        # filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=triplet_location,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.2,
                     outlier.shape = '', fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) + 
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +     
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=1,
             width=0.1,
             color='red') +          
        geom_hline(yintercept = c(0,0.5), linetype = 'dashed') +   
        theme(text = element_text(size=x_font_size)) + 
        ggtitle(paste0('All stages','; rt')) +
        facet_wrap(~dep_var_type, ncol = 1, strip.position = 'right')

fig4 <- tt_part_sum_stats_triplet_location %>%
        # filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=triplet_location,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '', fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        geom_line(aes(group=prolific_id),
                  alpha = 0.2) +    
        stat_summary(fun = mean,
                     color = 'red') + 
        stat_summary(fun.data = mean_cl_normal,
             geom = "errorbar",
             size=1,
             width=0.1,
             color='red') +          
        geom_hline(yintercept = c(0,0.5), linetype = 'dashed') +      
        theme(text = element_text(size=x_font_size)) + 
        facet_grid(dep_var_type~counterbalancing)

grid.arrange(fig3,fig4,
             nrow = 1,
             widths = 1:2)

```


```{r which-dep-var}

# What to plot on the y axis

plot_dep_var <- 'post_pre_diff'


if (plot_dep_var != 'post_pre_diff'){
        y_intercept <- 0.5        
} else {
        y_intercept <- 0
}

```

# Sorted x axis by dep var

```{r sorted-plot-chose-sparse, fig.width=13, fig.height=18}

# For sorted data
fig1 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=reorder(triplet_unique_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6, aes(color=curve_type)) + 
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 5,
                     color="black",
                     aes(shape = triplet_easiness)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = 'top') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Individual Triplets') +
        ggtitle('All counterbalancing groups')

fig2 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=reorder(triplet_unique_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 6, aes(color=curve_type)) + 
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 3,
                     color="black",
                     aes(shape = triplet_easiness),
                     position = position_dodge(width = 0.7)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        scale_fill_manual(values = c('white','gray')) +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Individual Triplets') +
        ggtitle('All counterbalancing groups')


fig3 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>%
        ggplot(aes(x=reorder(triplet_unique_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6,aes(color=curve_type)) +
        stat_summary(fun=mean,
                     color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Individual Triplets') +
        ggtitle('Faceting Dense Left & Right') +
        facet_wrap(~counterbalancing, ncol = 1, strip.position = 'right')

grid.arrange(fig1,fig2,fig3,
             nrow = 3,
             heights = c(1,1,2),
             top = 'Chose Sparse')
```

```{r sorted-plot-chose-high-dim-cb-differences, fig.width=13, fig.height=8}


# Unsorted both groups
fig1 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>%
        ggplot(aes(x=triplet_unique_name,
                   y=chose_towards_highdim_avg_across_reps)) +
        geom_boxplot(width = 0.5,
                     fatten = 4,
                     aes(color=curve_type)) +
        stat_summary(fun=mean,
                     color='black',
                     aes(shape = triplet_easiness),
                     size = 0.7,
                     position = position_dodge(width = 0.5)) +
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        scale_fill_manual(values=c('white','gray')) + 
        ylab(paste0(plot_dep_var, '; chose high-dim')) +
        xlab('Individual Triplets') +
        ggtitle('Both groups') +
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)


fig2 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>%
        ggplot(aes(x=triplet_unique_name,
                   y=chose_towards_highdim_avg_across_reps,
                   fill=counterbalancing)) +
        geom_boxplot(width = 0.5,
                     fatten = 4,
                     aes(color=curve_type)) +
        stat_summary(fun=mean,
                     color='black',
                     aes(shape = triplet_easiness),
                     size = 0.7,
                     position = position_dodge(width = 0.5)) +
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        scale_fill_manual(values=c('white','gray')) + 
        ylab(paste0(plot_dep_var, '; chose high-dim')) +
        xlab('Individual Triplets') +
        ggtitle('Both groups') +
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)

grid.arrange(fig1,fig2,
             nrow = 2,
             top = 'Choose high dimension')

```


# Triplets in density-relative space

```{r density-relative, fig.width=13, fig.height=18}

# For sorted data
fig1 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=reorder(density_relative_triplet_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6, aes(color=triplet_location)) + 
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 5,
                     color="black",
                     aes(shape = triplet_easiness)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = 'top') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('All counterbalancing groups')

fig2 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=reorder(density_relative_triplet_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 6, aes(color=triplet_location)) + 
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +        
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 3,
                     color="black",
                     aes(shape = triplet_easiness),
                     position = position_dodge(width = 0.7)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        scale_fill_manual(values = c('white','gray')) +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('All counterbalancing groups')


fig3 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>%
        ggplot(aes(x=reorder(density_relative_triplet_name,-chose_towards_sparse_avg_across_reps),
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6,aes(color=triplet_location)) +
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +        
        stat_summary(fun=mean,
                     color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('Dense Left & Right') +
        facet_wrap(~counterbalancing, ncol = 1, strip.position = 'right')

grid.arrange(fig1,fig2,fig3,
             nrow = 3,
             heights = c(1,1,2),
             top = 'DENSITY RELATIVE. Chose Sparse')
```

```{r density-relative-unsorted, fig.width=13, fig.height=18}

# For sorted data
fig1 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=density_relative_triplet_name,
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6, aes(color=triplet_location)) + 
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 5,
                     color="black",
                     aes(shape = triplet_easiness)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = 'top') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('All counterbalancing groups')+
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)

fig2 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>% 
        ggplot(aes(x=density_relative_triplet_name,
                   y=chose_towards_sparse_avg_across_reps,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 6, aes(color=triplet_location)) + 
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +        
        stat_summary(fun=mean,
                     geom = 'point',
                     size = 3,
                     color="black",
                     aes(shape = triplet_easiness),
                     position = position_dodge(width = 0.7)) + 
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        scale_fill_manual(values = c('white','gray')) +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('All counterbalancing groups') +
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)


fig3 <- tt_long_post_pre_and_diff %>%
        filter(dep_var_type == plot_dep_var) %>%
        ggplot(aes(x=density_relative_triplet_name,
                   y=chose_towards_sparse_avg_across_reps)) +
        geom_boxplot(fatten = 6,aes(color=triplet_location)) +
        scale_color_manual(values=c("black",
                       "purple",
                       '#ffa303')) +        
        stat_summary(fun=mean,
                     color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = y_intercept, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') +
        ylab(paste0(plot_dep_var, '; chose sparse')) +
        xlab('Density relative triplets!') +
        ggtitle('Both groups faceted') +
        facet_wrap(~counterbalancing, ncol = 1, strip.position = 'right') +
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)

grid.arrange(fig1,fig2,fig3,
             nrow = 3,
             heights = c(1,1,2),
             top = 'DENSITY RELATIVE. Chose Sparse')
```



## Across minus dense

```{r sorted-plot-triplet-location-diff-socres-1, fig.width=8, fig.height=20}

# For sorted data

fig1 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == plot_dep_var,
               difference_type == 'across_minus_dense',
               measure_type == 'rt') %>% 
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) + 
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Dense:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')

fig2 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == plot_dep_var,
               difference_type == 'across_minus_dense',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1,
                     position = position_dodge(width = 0.7)) + 
        scale_fill_manual(values = c('white','gray')) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Dense:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')


fig3 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_right',
               dep_var_type == plot_dep_var,
               difference_type == 'across_minus_dense',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Dense:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Right')

fig4 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_left',
               dep_var_type == plot_dep_var,
               difference_type == 'across_minus_dense',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Dense:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Left')
        

grid.arrange(fig1,fig2,fig3,fig4,
             nrow = 4,
             top = 'Across - Dense')


```



## Across minus sparse

```{r sorted-plot-triplet-location-diff-socres-2, fig.width=8, fig.height=20}

# For sorted data

fig1 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == 'post_pre_diff',
               difference_type == 'across_minus_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) + 
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Sparse:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')

fig2 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == plot_dep_var,
               difference_type == 'across_minus_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1,
                     position = position_dodge(width = 0.7)) + 
        scale_fill_manual(values = c('white','gray')) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Dense:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')

fig3 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_right',
               dep_var_type == 'post_pre_diff',
               difference_type == 'across_minus_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Sparse:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Right')

fig4 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_left',
               dep_var_type == 'post_pre_diff',
               difference_type == 'across_minus_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-Sparse:\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Left')
        

grid.arrange(fig1,fig2,fig3,fig4,
             nrow = 4,
             top = 'Across - Sparse')

```


## Across minus avg(dense,sparse)

```{r sorted-plot-triplet-location-diff-socres-3, fig.width=8, fig.height=20}

fig1 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == plot_dep_var,
               difference_type == 'across_minus_avg_dense_sparse',
               measure_type == 'rt') %>% 
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) + 
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-avg(sparse+dense):\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')

fig2 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(dep_var_type == plot_dep_var,
               difference_type == 'across_minus_avg_dense_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value,
                   fill=counterbalancing)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1,
                     position = position_dodge(width = 0.7)) + 
        scale_fill_manual(values = c('white','gray')) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-avg(sparse+dense):\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Both counterbalancing groups')


fig3 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_right',
               dep_var_type == plot_dep_var,
               difference_type == 'across_minus_avg_dense_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-avg(sparse+dense):\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Right')

fig4 <- tt_part_sum_stats_triplet_location_template_differences %>%
        filter(counterbalancing == 'dense_left',
               dep_var_type == plot_dep_var,
               difference_type == 'across_minus_avg_dense_sparse',
               measure_type == 'rt') %>%
        ggplot(aes(x=reorder(template_distances,-difference_value),
                   y=difference_value)) +
        geom_boxplot(fatten = 4,aes(color=template_distances)) + 
        stat_summary(fun=mean,color='black',
                     aes(shape = triplet_easiness),
                     size = 1) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = '') + 
        ylab('Across-avg(sparse+dense):\n Post-pre chose low-density') + 
        xlab('Templates') +
        ggtitle('Dense Left')
        

grid.arrange(fig1,fig2,fig3,fig4,
             nrow = 4,
             top = 'Across - avg(sparse+dense)')



```

# Between participant comparisons:

## Averaging over all triplets:

```{r between-subj-overall, fig.width=5, fig.height=4, warning=F}

ylimits <- c(-0.2,0.2)

fig1 <- tt_part_sum_stats %>%
        filter(dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '', 
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') + 
        coord_cartesian(ylim = ylimits) + 
        ggtitle('rt')

fig2 <- tt_part_sum_stats %>%
        filter(dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_chose_towards_highdim)) +
        geom_violin(fill = chose_highdim_color,
                    alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '', 
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') + 
        coord_cartesian(ylim = ylimits) + 
        ggtitle('Chose towards high dimension')
        

grid.arrange(fig1,fig2,
             nrow = 1,
             top = 'Post minus pre')

```

## Triplet location

```{r between-subj-triplet-location, fig.width=7, fig.height=6, warning=F}

ylimits <- c(-0.4,0.4)

fig1 <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_rt)) +
        geom_violin(fill = rt_color,
                    alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '', 
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') + 
        coord_cartesian(ylim = ylimits) + 
        facet_wrap(~triplet_location) +
        ggtitle('rt')

fig2 <- tt_part_sum_stats_triplet_location %>%
        filter(dep_var_type == 'post_pre_diff') %>%
        ggplot(aes(x=counterbalancing,
                   y=mean_chose_towards_highdim)) +
        geom_violin(fill = chose_highdim_color,
                    alpha = 0.2) +
        geom_boxplot(width=0.15,
                     outlier.shape = '', 
                     fatten = 4) +
        geom_jitter(width = 0.05,
                    height = 0,
                    alpha = 0.3) +
        stat_summary(fun = mean,
                     color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
        stat_summary(fun.data = mean_cl_normal,
                     geom = "errorbar",
                     size=0.5,
                     width=0.1,
                     color='red') + 
        coord_cartesian(ylim = ylimits) + 
        facet_wrap(~triplet_location) + 
        ggtitle('Chose towards high dimension')

# fig3 <- tt_part_sum_stats_triplet_location %>%
#         filter(dep_var_type == 'post_pre_diff') %>%
#         ggplot(aes(x=counterbalancing,
#                    y=mean_correct)) +
#         geom_violin(fill = accuracy_color,
#                     alpha = 0.2) +
#         geom_boxplot(width=0.15,
#                      outlier.shape = '', 
#                      fatten = 4) +
#         geom_jitter(width = 0.05,
#                     height = 0,
#                     alpha = 0.3) +
#         stat_summary(fun = mean,
#                      color = 'red') + geom_hline(yintercept = 0, linetype = 'dashed') + 
#         stat_summary(fun.data = mean_cl_normal,
#                      geom = "errorbar",
#                      size=0.5,
#                      width=0.1,
#                      color='red') + 
#         coord_cartesian(ylim = ylimits) + 
#         facet_wrap(~triplet_location) + 
#         ggtitle('Accuracy')


grid.arrange(fig1,fig2,
             # fig4,fig5,fig6,
             ncol = 1,
             top = 'Post minus pre')

```

```{r fig.width=13, fig.height=4}

tt_bw_part_sum_stats_triplets_difference %>%
        filter(dep_var_type == 'post_pre_diff',
               measure_type == 'chose_towards_highdim') %>%
        ggplot(aes(x=triplet_unique_name,
                   y=difference_value)) +
        geom_hline(yintercept = 0, linetype = 'dashed') +
        geom_point(aes(color = curve_type,
                       shape = triplet_easiness),
                   size = 3) +
        theme(axis.text.x = element_text(angle = 90),
              legend.position = 'right') +
        ylab('Dense_right - Dense_left') + 
        xlab('Individual Triplets') +
        ggtitle('(UNSORTED) Post-pre chose high-dimension: Counterbalancing group difference') +
        geom_vline(xintercept = seq(0.5,27.5,3), 
                   linetype = 'dashed',
                   alpha = 0.5)

```





























